% =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
%
% Author: Mark H. Olson
% Website: https://mholson.com
% Github: https://github.com/mholson
% 
% File: mhoexamgy.sty
% Created: 2015-08-18
%
% Description: This package is used to extend customize the exam.cls.
% =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=

% =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
%	PACKAGE OPTIONS & SETUP
% =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\ProvidesPackage{mhoexamgy}
\RequirePackage{mhoexam}
% > > > Fonts
\RequirePackage[sfdefault,vvarbb]{notomath}
\RequirePackage[scale=\NotoText@scale]{noto-mono}
\setoperatorfont\symrm
\RequirePackage{metalogo}

% > > > LINKS
\RequirePackage[unicode]{hyperref}

% -- DOCUMENT PDF INFORMATION
\hypersetup{
  % AUTHOR OF THE DOCUMENT
  pdfauthor = {Mark H. Olson: mark.olson@amerikanskagymnasiet.se},
  % SUBJECT OF THE DOCUMENT
  pdfsubject = {\examsubject},
  % DOCUMENT KEYWORDS
  pdfkeywords = {\documentkeywords},
  % DOCUMENT LAST MODIFICATIONS - USES DATE TIME PACKAGE
  pdfmoddate= {D:\pdfdate},
  % CREATOR OF THE DOCUMENT
  pdfcreator = {LaTeX with hyperref package},
  % FALSE: BOXED LINKS; TRUE: COLORED LINKS
  colorlinks=true,
  % COLOR OF INTERNAL LINKS
  linkcolor=Blue,
  % COLOR OF CITATIONS
  citecolor=Blue,
  % COLOR OF EXTERNAL LINKS
  urlcolor=Blue}
% =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
% Enumerated Lists
% =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\RequirePackage[shortlabels]{enumitem}
% \setlist{noitemsep}
\setlist[1]{labelindent=\parindent} % < Usually a good idea
\setlist[itemize]{leftmargin=*}
\setlist[itemize,1]{label=\( \circledcirc \) }
\setlist[enumerate]{labelsep=*, leftmargin=2pc}
% \setlist[enumerate,1]{label = \arabic*.,
% ref   = \arabic*}
\setlist[enumerate,1]{label = (\cRed{\alph*}),
  ref   = \theenumi.\emph{\alph*}}
\setlist[enumerate,2]{label = \cRed{\roman*}),
  ref   = \theenumii.\roman*}
\setlist[description]{font=\sffamily\bfseries}


% > > > POINTS
\pointsinrightmargin
\marginpointname{}
\pointname{}
\extrawidth{-0.1in}

% > > > EXAM PART
\newcommand{\exampart}{\begin{tikzpicture}
    \node[draw=Blue,line width=1pt,rectangle,fill=Blue!25,font=\sffamily\bfseries,inner sep=2pt,outer sep=0pt] at (0pt,0pt){\cBlue{Exam \examnumber}};\end{tikzpicture}}

% > > > STUDENT NAME BOX
\def\boxentry[#1]#2{{\setlength{\fboxsep}{-\fboxrule}\fbox{\parbox{#1}{\smash{\raise-6.5pt\hbox{~{\scriptsize #2}}}\vspace{6ex}\mbox{}}}}}

% RUNNING PAGE HEADER
\runningheader {\documenttitle}{- \thepage - }{\documentversion} \runningheadrule

% PAGE FOOTER
\RequirePackage{xstring}
\newcommand{\customjobname}{\StrLeft{\jobname}{21}}
\footer{\tiny \customjobname}{}{}

\runningfooter{\tiny \customjobname}
{}
{\iflastpage{}{}}

  \headrule
  \header{\calculatorpermission.  Write your answers \writesolutions}{}{\exampart}{
    \footer{}
    {Page \thepage\ of \numpages}
    {\small \customjobname}

    % > > > COVER PAGE
    \def\makecoverpage{
      \begin{coverpages}

        \begin{center}
          \includegraphics[width=0.25\textwidth]{images/logoAGS} \\

          \vspace{2em}

          \cSteelI{\Huge{\textbf{\course\, -- \courseterm}}}\\

          \vspace{2em}

          \Huge{\exampart} \\

          \vspace{1em}

          \Large{\examduration}
        \end{center}

        \vspace{1em}

        \begin{center}
          \cRed{\textbf{DO NOT OPEN THE EXAM BOOKLET UNTIL INSTRUCTED TO DO SO}}\\

          \vspace{1em}

          \boxentry[0.45\hsize]{Name:} \boxentry[0.25\hsize]{Class:} \boxentry[0.15\hsize]{Pages Submitted:}
        \end{center}
        \vspace{1em}

        \begin{itemize}
          \item \emph{Please make sure that you write your \textbf{name}, and a page number in the top right-hand corner of each squared paper handed-in.}
          \item \emph{All solutions are to be neatly written in the order they appear on the exam.}
          \item \emph{Illegible work will not be graded.}
          \item \emph{All work that you do not want to be graded must be neatly crossed-out - including scrap papers.}
        \end{itemize}
        \vspace{0.75cm}

        \colorbox{SteelII}{
          \begin{minipage}[c]{.4\linewidth}
            \begin{center}
              \textbf{\Large{\cSteelI{Points}}} \\[1em]
              \framebox{\cSteelI{\Large{\textbf{\epoints \, E} \quad \textbf{\cpoints \, C} \quad \textbf{\apoints \, A}}}}
            \end{center}
          \end{minipage}

          \begin{minipage}[c]{.53\linewidth}
            \begin{itemize}
              \item \calculatorpermission
              \item Write your answers \writesolutions
              \item \formulabooklet
            \end{itemize}
          \end{minipage}
        }

        \vspace{0.75cm}

        \begin{center}
          \cRed{\textbf{IT IS FORBIDDEN TO TAKE ANY EXAM MATERIALS FROM THE EXAM AREA}}
        \end{center}

        \vfill

      \end{coverpages}

      \newpage
    }

    \endinput
    % =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
    % End of file `mhoexamgy.sty'.
    % =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
